<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Loop Automation - Project Management</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=DM+Sans:ital,opsz,wght@0,9..40,100..1000;1,9..40,100..1000&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
    <!-- PDF Export Library -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
</head>
<body>
    <div class="app-container">
        <!-- Sidebar Navigation -->
        <aside class="sidebar">
            <div class="logo">
                <div class="logo-icon">
                    <svg viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <circle cx="20" cy="20" r="18" stroke="currentColor" stroke-width="2.5"/>
                        <path d="M14 20C14 16.6863 16.6863 14 20 14C23.3137 14 26 16.6863 26 20" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
                        <circle cx="20" cy="20" r="3" fill="currentColor"/>
                    </svg>
                </div>
                <div class="logo-text">
                    <span class="logo-name">Loop</span>
                    <span class="logo-sub">Automation</span>
                </div>
            </div>
            
            <nav class="nav-menu">
                <button class="nav-item active" data-view="dashboard">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <rect x="3" y="3" width="7" height="7" rx="1"/>
                        <rect x="14" y="3" width="7" height="7" rx="1"/>
                        <rect x="3" y="14" width="7" height="7" rx="1"/>
                        <rect x="14" y="14" width="7" height="7" rx="1"/>
                    </svg>
                    <span>Dashboard</span>
                </button>
                <button class="nav-item" data-view="gantt">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="3" y1="6" x2="21" y2="6"/>
                        <line x1="3" y1="12" x2="15" y2="12"/>
                        <line x1="3" y1="18" x2="18" y2="18"/>
                        <circle cx="21" cy="6" r="2" fill="currentColor"/>
                        <circle cx="15" cy="12" r="2" fill="currentColor"/>
                        <circle cx="18" cy="18" r="2" fill="currentColor"/>
                    </svg>
                    <span>Project Overview</span>
                </button>
                <button class="nav-item" data-view="team">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="7" r="4"/>
                        <path d="M5 21v-2a4 4 0 014-4h6a4 4 0 014 4v2"/>
                    </svg>
                    <span>Team Members</span>
                </button>
            </nav>

            <div class="sidebar-footer">
                <button class="btn-validate" onclick="validateProject()">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M9 12l2 2 4-4"/>
                        <circle cx="12" cy="12" r="9"/>
                    </svg>
                    Validate Project
                </button>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Dashboard View -->
            <section id="dashboard-view" class="view active">
                <header class="view-header">
                    <h1>Project Dashboard</h1>
                    <p class="view-subtitle">Overview of project status and team workload</p>
                </header>

                <div class="dashboard-grid">
                    <!-- Stats Cards -->
                    <div class="stats-row">
                        <div class="stat-card">
                            <div class="stat-icon total">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <rect x="3" y="3" width="18" height="18" rx="2"/>
                                    <path d="M3 9h18"/>
                                </svg>
                            </div>
                            <div class="stat-info">
                                <span class="stat-value" id="total-phases">0</span>
                                <span class="stat-label">Project Phases</span>
                            </div>
                        </div>
                        
                        <div class="stat-card">
                            <div class="stat-icon tasks">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2"/>
                                    <rect x="9" y="3" width="6" height="4" rx="1"/>
                                </svg>
                            </div>
                            <div class="stat-info">
                                <span class="stat-value" id="total-tasks">0</span>
                                <span class="stat-label">Total Tasks</span>
                            </div>
                        </div>
                        
                        <div class="stat-card">
                            <div class="stat-icon complete">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M9 12l2 2 4-4"/>
                                    <circle cx="12" cy="12" r="9"/>
                                </svg>
                            </div>
                            <div class="stat-info">
                                <span class="stat-value" id="completed-tasks">0</span>
                                <span class="stat-label">Completed</span>
                            </div>
                        </div>
                        
                        <div class="stat-card">
                            <div class="stat-icon progress">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <circle cx="12" cy="12" r="9"/>
                                    <path d="M12 6v6l4 2"/>
                                </svg>
                            </div>
                            <div class="stat-info">
                                <span class="stat-value" id="in-progress-tasks">0</span>
                                <span class="stat-label">In Progress</span>
                            </div>
                        </div>
                    </div>

                    <!-- Hours Overview -->
                    <div class="hours-overview">
                        <h3>Hours Overview</h3>
                        <div class="hours-grid">
                            <div class="hours-item">
                                <span class="hours-value" id="total-est-hours">0</span>
                                <span class="hours-label">Estimated Hours</span>
                            </div>
                            <div class="hours-item">
                                <span class="hours-value" id="total-actual-hours">0</span>
                                <span class="hours-label">Actual Hours</span>
                            </div>
                            <div class="hours-item">
                                <span class="hours-value" id="remaining-hours">0</span>
                                <span class="hours-label">Remaining</span>
                            </div>
                        </div>
                        <div class="progress-bar-container">
                            <div class="progress-bar" id="hours-progress"></div>
                        </div>
                    </div>

                    <!-- Team Workload -->
                    <div class="team-workload">
                        <h3>Team Workload</h3>
                        <div class="workload-table-container">
                            <table class="workload-table">
                                <thead>
                                    <tr>
                                        <th>Name</th>
                                        <th>Role</th>
                                        <th>Target Hrs</th>
                                        <th>Assigned Hrs</th>
                                        <th>Variance</th>
                                        <th>Load</th>
                                    </tr>
                                </thead>
                                <tbody id="workload-tbody"></tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Gantt Chart View (Project Overview) -->
            <section id="gantt-view" class="view">
                <header class="view-header">
                    <div class="header-left">
                        <h1>Project Overview</h1>
                        <p class="view-subtitle">Click on a phase to view detailed tasks and assignments</p>
                    </div>
                    <div class="header-actions">
                        <button class="btn-secondary" onclick="exportToPDF()">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"/>
                                <polyline points="14,2 14,8 20,8"/>
                                <line x1="16" y1="13" x2="8" y2="13"/>
                                <line x1="16" y1="17" x2="8" y2="17"/>
                            </svg>
                            Export PDF
                        </button>
                        <button class="btn-secondary" onclick="exportToCSV()">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4"/>
                                <polyline points="7,10 12,15 17,10"/>
                                <line x1="12" y1="15" x2="12" y2="3"/>
                            </svg>
                            Export CSV
                        </button>
                        <button class="btn-primary" onclick="addNewPhase()">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <line x1="12" y1="5" x2="12" y2="19"/>
                                <line x1="5" y1="12" x2="19" y2="12"/>
                            </svg>
                            Add Phase
                        </button>
                    </div>
                </header>

                <div class="gantt-container" id="gantt-export-area">
                    <div class="gantt-phases" id="gantt-phases"></div>
                </div>
            </section>

            <!-- Phase Detail View -->
            <section id="phase-detail-view" class="view">
                <header class="view-header">
                    <div class="header-left">
                        <button class="btn-back" onclick="backToOverview()">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M19 12H5M12 19l-7-7 7-7"/>
                            </svg>
                            Back to Overview
                        </button>
                        <h1 id="phase-detail-title">Phase Name</h1>
                        <p class="view-subtitle" id="phase-detail-subtitle">Phase details and task breakdown</p>
                    </div>
                    <div class="header-actions">
                        <button class="btn-secondary" onclick="exportPhaseToPDF()">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"/>
                                <polyline points="14,2 14,8 20,8"/>
                            </svg>
                            Export PDF
                        </button>
                        <button class="btn-primary" onclick="addNewTask()">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <line x1="12" y1="5" x2="12" y2="19"/>
                                <line x1="5" y1="12" x2="19" y2="12"/>
                            </svg>
                            Add Task
                        </button>
                    </div>
                </header>

                <div class="phase-detail-content" id="phase-export-area">
                    <!-- Phase Summary -->
                    <div class="phase-summary" id="phase-summary"></div>
                    
                    <!-- Tasks Table -->
                    <div class="phase-tasks-container">
                        <h3>Task Breakdown</h3>
                        <table class="tasks-detail-table">
                            <thead>
                                <tr>
                                    <th>Task</th>
                                    <th>Assigned To</th>
                                    <th>Role</th>
                                    <th>Start</th>
                                    <th>End</th>
                                    <th>Est Hrs</th>
                                    <th>Actual</th>
                                    <th>Status</th>
                                    <th>Priority</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="phase-tasks-tbody"></tbody>
                        </table>
                    </div>

                    <!-- Phase Timeline -->
                    <div class="phase-timeline-container">
                        <h3>Task Timeline</h3>
                        <div class="phase-timeline" id="phase-timeline"></div>
                    </div>

                    <!-- Team Assignments for this Phase -->
                    <div class="phase-team-container">
                        <h3>Team Assignments</h3>
                        <div class="phase-team-grid" id="phase-team-grid"></div>
                    </div>
                </div>
            </section>

            <!-- Team Members View -->
            <section id="team-view" class="view">
                <header class="view-header">
                    <div class="header-left">
                        <h1>Team Members</h1>
                        <p class="view-subtitle">Manage team and track assignments</p>
                    </div>
                    <div class="header-actions">
                        <button class="btn-primary" onclick="addNewTeamMember()">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <line x1="12" y1="5" x2="12" y2="19"/>
                                <line x1="5" y1="12" x2="19" y2="12"/>
                            </svg>
                            Add Member
                        </button>
                    </div>
                </header>

                <div class="team-grid" id="team-grid"></div>
            </section>
        </main>
    </div>

    <!-- Phase Modal -->
    <div class="modal-overlay" id="phase-modal">
        <div class="modal">
            <div class="modal-header">
                <h2 id="phase-modal-title">Add Phase</h2>
                <button class="modal-close" onclick="closeModal('phase-modal')">&times;</button>
            </div>
            <form id="phase-form" class="modal-body">
                <input type="hidden" id="phase-id">
                <div class="form-row">
                    <div class="form-group">
                        <label for="phase-name">Phase Name</label>
                        <input type="text" id="phase-name" required placeholder="e.g., Development Phase 1">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="phase-description">Description</label>
                        <textarea id="phase-description" rows="3" placeholder="Brief description of this phase..."></textarea>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="phase-start">Start Date</label>
                        <input type="date" id="phase-start" required>
                    </div>
                    <div class="form-group">
                        <label for="phase-end">End Date</label>
                        <input type="date" id="phase-end" required>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="phase-color">Phase Color</label>
                        <input type="color" id="phase-color" value="#00d4aa">
                    </div>
                    <div class="form-group">
                        <label for="phase-priority">Priority</label>
                        <select id="phase-priority">
                            <option value="Low">Low</option>
                            <option value="Medium" selected>Medium</option>
                            <option value="High">High</option>
                            <option value="Critical">Critical</option>
                        </select>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn-secondary" onclick="closeModal('phase-modal')">Cancel</button>
                    <button type="submit" class="btn-primary">Save Phase</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Task Modal -->
    <div class="modal-overlay" id="task-modal">
        <div class="modal">
            <div class="modal-header">
                <h2 id="task-modal-title">Add Task</h2>
                <button class="modal-close" onclick="closeModal('task-modal')">&times;</button>
            </div>
            <form id="task-form" class="modal-body">
                <input type="hidden" id="task-id">
                <input type="hidden" id="task-phase-id">
                <div class="form-row">
                    <div class="form-group">
                        <label for="task-name">Task Name</label>
                        <input type="text" id="task-name" required>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="task-assigned">Assigned To</label>
                        <select id="task-assigned" required></select>
                    </div>
                    <div class="form-group">
                        <label for="task-priority">Priority</label>
                        <select id="task-priority" required>
                            <option value="Low">Low</option>
                            <option value="Medium" selected>Medium</option>
                            <option value="High">High</option>
                            <option value="Critical">Critical</option>
                        </select>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="task-start">Start Date</label>
                        <input type="date" id="task-start" required>
                    </div>
                    <div class="form-group">
                        <label for="task-end">End Date</label>
                        <input type="date" id="task-end" required>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="task-est-hours">Estimated Hours</label>
                        <input type="number" id="task-est-hours" min="0" step="0.5" required>
                    </div>
                    <div class="form-group">
                        <label for="task-actual-hours">Actual Hours</label>
                        <input type="number" id="task-actual-hours" min="0" step="0.5" value="0">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="task-status">Status</label>
                        <select id="task-status" required>
                            <option value="Not Started">Not Started</option>
                            <option value="In Progress">In Progress</option>
                            <option value="Complete">Complete</option>
                            <option value="On Hold">On Hold</option>
                            <option value="Delayed">Delayed</option>
                        </select>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="task-notes">Notes</label>
                        <textarea id="task-notes" rows="2" placeholder="Additional notes..."></textarea>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn-secondary" onclick="closeModal('task-modal')">Cancel</button>
                    <button type="submit" class="btn-primary">Save Task</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Team Member Modal -->
    <div class="modal-overlay" id="team-modal">
        <div class="modal">
            <div class="modal-header">
                <h2 id="team-modal-title">Add Team Member</h2>
                <button class="modal-close" onclick="closeModal('team-modal')">&times;</button>
            </div>
            <form id="team-form" class="modal-body">
                <input type="hidden" id="member-index">
                <div class="form-row">
                    <div class="form-group">
                        <label for="member-name">Name</label>
                        <input type="text" id="member-name" required>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="member-role">Role</label>
                        <select id="member-role" required>
                            <option value="PM">Project Manager</option>
                            <option value="Lead">Lead</option>
                            <option value="Member">Member</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="member-target">Target Hours</label>
                        <input type="number" id="member-target" min="0" value="40" required>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="member-email">Email</label>
                        <input type="email" id="member-email">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="member-color">Color</label>
                        <input type="color" id="member-color" value="#3498db">
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn-secondary" onclick="closeModal('team-modal')">Cancel</button>
                    <button type="submit" class="btn-primary">Save Member</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Validation Modal -->
    <div class="modal-overlay" id="validation-modal">
        <div class="modal validation-modal">
            <div class="modal-header">
                <h2>Project Validation</h2>
                <button class="modal-close" onclick="closeModal('validation-modal')">&times;</button>
            </div>
            <div class="modal-body" id="validation-results"></div>
            <div class="modal-footer">
                <button class="btn-primary" onclick="closeModal('validation-modal')">Close</button>
            </div>
        </div>
    </div>

    <script src="app.js"></script>
</body>
</html>
